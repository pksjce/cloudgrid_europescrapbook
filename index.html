<html>
	<head>
		<link rel="stylesheet" href="index.css" title="CloudGrid stylesheet">
		<link rel="stylesheet" href="component.css">
	</head>
	<body>
		<div class="md-modal md-effect-1" id="modal-1">
			<div class="md-content">
				<h3>Modal Dialog</h3>
				<div>
					<p>This is a modal window. You can do the following things with it:</p>
					<ul>
						<li><strong>Read:</strong> modal windows will probably tell you something important so don't forget to read what they say.</li>
						<li><strong>Look:</strong> a modal window enjoys a certain kind of attention; just look at it and appreciate its presence.</li>
						<li><strong>Close:</strong> click on the button below to close the modal.</li>
					</ul>
					<button class="md-close">Close me!</button>
				</div>
			</div>
		</div>
		<div class='grid'></div>
		<div class="md-overlay"></div><!-- the overlay element -->
		
		<script src="http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.5.2/underscore-min.js"></script>
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
        <script src="cloudGrid.js"></script>
        <!-- classie.js by @desandro: https://github.com/desandro/classie -->
		<script src="classie.js"></script>
        <script type='text/javascript'>
        	// Create a random number of items between 100 and 200.
			var $element;
			var children = [];
			var $gridContainer = $('.grid');
			var items = 20;
			var columns;
			var rows;

			for (var i=0; i < items; i++) {
				// Set the number of rows and columns the element should use.
				$element = $('<div>').addClass('gridItem').addClass('md-trigger').attr('data-modal','modal-1');
				columns = 6 ;
				rows = 5 + Math.floor(Math.random() * 200) % 5;

				$element.text(columns + 'x' + rows);
				$.data($element, 'grid-columns', columns);
				$.data($element, 'grid-rows', rows);
				$gridContainer.append($element);
				children.push($element);
			}

			$gridContainer.cloudGrid({
				children: children,
				gridGutter: 13,
				gridSize: 20
			});
			init();
			function init() {
				var overlay = document.querySelector( '.md-overlay' );
				[].slice.call( document.querySelectorAll( '.md-trigger' ) ).forEach( function( el, i ) {
					var modal = document.querySelector( '#' + el.getAttribute( 'data-modal' ) ),
						close = modal.querySelector( '.md-close' );
					function removeModal( hasPerspective ) {
						classie.remove( modal, 'md-show' );
						if( hasPerspective ) {
							classie.remove( document.documentElement, 'md-perspective' );
						}
					}
					function removeModalHandler() {
						removeModal( classie.has( el, 'md-setperspective' ) ); 
					}
					el.addEventListener( 'click', function( ev ) {
						classie.add( modal, 'md-show' );
						overlay.removeEventListener( 'click', removeModalHandler );
						overlay.addEventListener( 'click', removeModalHandler );

						if( classie.has( el, 'md-setperspective' ) ) {
							setTimeout( function() {
								classie.add( document.documentElement, 'md-perspective' );
							}, 25 );
						}
					});
					close.addEventListener( 'click', function( ev ) {
						ev.stopPropagation();
						removeModalHandler();
					});
				});
			}; 

			$(window).on('resize', function() {
				$gridContainer.cloudGrid('reflowContent');
			})
        </script>
	</body>
</html>